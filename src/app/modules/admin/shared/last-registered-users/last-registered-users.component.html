<div class="last-registered-users-container">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <div class="title-section">
        <i class="material-icons title-icon">people</i>
        <h2 class="title">Últimos usuarios registrados</h2>
      </div>
      <div class="header-actions">
        <button class="refresh-btn" (click)="refreshUsers()" [disabled]="isLoading">
          <i class="material-icons" [class.rotating]="isLoading">refresh</i>
          <span class="btn-text">{{ 'refresh' | workyTranslations }}</span>
        </button>
      </div>
    </div>
    <div class="stats-section">
      <div class="stat-card">
        <i class="material-icons stat-icon active">check_circle</i>
        <div class="stat-content">
          <span class="stat-number">{{ activeUsersCount }}</span>
          <span class="stat-label">Usuarios Activos</span>
        </div>
      </div>
      <div class="stat-card">
        <i class="material-icons stat-icon pending">schedule</i>
        <div class="stat-content">
          <span class="stat-number">{{ pendingUsersCount }}</span>
          <span class="stat-label">Pendiente de Verificación</span>
        </div>
      </div>
      <div class="stat-card">
        <i class="material-icons stat-icon inactive">cancel</i>
        <div class="stat-content">
          <span class="stat-number">{{ inactiveUsersCount }}</span>
          <span class="stat-label">Usuarios Desactivados</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner">
      <i class="material-icons rotating">refresh</i>
      <p class="loading-text">{{ 'loadingUsers' | workyTranslations }}</p>
    </div>
  </div>

  <!-- Users Grid -->
  <div class="users-grid" *ngIf="!isLoading && users.length > 0">
    <div class="user-card" *ngFor="let user of users; trackBy: trackByUserId">
      <div class="card-header">
        <div class="user-avatar">
          <worky-avatar 
            [size]="50"
            [img]="user?.avatar"
            [name]="user?.name + ' ' + user.lastName">
          </worky-avatar>
          <div class="status-indicator" [class]="getStatusClass(user)"></div>
        </div>
        <div class="user-info">
          <h3 class="user-name">{{ user?.name }} {{ user?.lastName }}</h3>
          <p class="user-username">&#64;{{ user.username }}</p>
          <p class="user-email">{{ user.email }}</p>
        </div>
      </div>
      
      <div class="card-body">
        <div class="user-details">
          <div class="detail-item">
            <i class="material-icons detail-icon">calendar_today</i>
            <span class="detail-label">Fecha de registro:</span>
            <span class="detail-value">{{ user.createdAt | date:'longDate':'':'es' }}</span>
          </div>
          <div class="detail-item">
            <i class="material-icons detail-icon">access_time</i>
            <span class="detail-label">Último ingreso:</span>
            <span class="detail-value">{{ user.updatedAt | date:'medium':'':'es' }}</span>
          </div>
          <div class="detail-item">
            <i class="material-icons detail-icon">security</i>
            <span class="detail-label">Rol:</span>
            <span class="detail-value role-badge" [class]="getRoleClass(user.role)">
              {{ user.role | titlecase }}
            </span>
          </div>
        </div>
        
        <div class="verification-status">
          <div class="status-badge" [class]="getVerificationClass(user)">
            <i class="material-icons" [class.verified-icon]="user.isVerified" [class.pending-icon]="!user.isVerified">
              {{ user.isVerified ? 'verified' : 'warning' }}
            </i>
            <span>{{ user.isVerified ? 'Verificado' : 'Pendiente de verificación' }}</span>
          </div>
        </div>

        <div class="card-actions">
          <div class="toggle-container">
            <span class="toggle-label">{{ user.isActive ? 'Activo' : 'Inactivo' }}</span>
            <label class="toggle-switch">
              <input 
                type="checkbox" 
                [checked]="user.isActive"
                (change)="toggleUserStatus(user)"
                [disabled]="updatingUsers.has(user._id)">
              <span class="toggle-slider" [class.loading]="updatingUsers.has(user._id)"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && users.length === 0">
    <div class="empty-content">
      <i class="material-icons empty-icon">people</i>
      <h3 class="empty-title">{{ 'noUsersFound' | workyTranslations }}</h3>
      <p class="empty-description">{{ 'noUsersDescription' | workyTranslations }}</p>
      <button class="refresh-btn primary" (click)="refreshUsers()">
        <i class="material-icons">refresh</i>
        <span class="btn-text">{{ 'tryAgain' | workyTranslations }}</span>
      </button>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error">
    <div class="error-content">
      <i class="material-icons error-icon">warning</i>
      <h3 class="error-title">{{ 'errorLoadingUsers' | workyTranslations }}</h3>
      <p class="error-description">{{ error }}</p>
      <button class="refresh-btn primary" (click)="refreshUsers()">
        <i class="material-icons">refresh</i>
        <span class="btn-text">{{ 'tryAgain' | workyTranslations }}</span>
      </button>
    </div>
  </div>
</div>
