<div class="manage-reactions-dashboard">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="header-content">
      <div class="header-title">
        <h1 class="title">Gesti贸n de Reacciones</h1>
        <p class="subtitle">Crea y administra reacciones personalizadas para la plataforma</p>
      </div>
      <div class="header-actions">
        <button class="refresh-btn" (click)="listReactions()" [disabled]="loadReactionsButtons">
          <i class="material-icons" [class.rotating]="loadReactionsButtons">refresh</i>
          <span class="btn-text">Recargar</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Initial Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-content">
      <div class="loading-spinner">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
      </div>
      <div class="loading-text">
        <h3>Cargando reacciones</h3>
        <p>Recopilando reacciones personalizadas...</p>
        <div class="loading-dots">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error && !isLoading">
    <div class="error-content">
      <div class="error-icon">
        <i class="material-icons">error_outline</i>
      </div>
      <div class="error-text">
        <h3>Error al cargar reacciones</h3>
        <p>{{ error }}</p>
        <button class="retry-btn" (click)="listReactions()">
          <i class="material-icons">refresh</i>
          Reintentar
        </button>
      </div>
    </div>
  </div>

  <!-- Processing Loading State -->
  <div class="processing-container" *ngIf="loadReactionsButtons && !isLoading">
    <div class="processing-content">
      <div class="processing-spinner">
        <i class="material-icons rotating">refresh</i>
      </div>
      <div class="processing-text">
        <h3>Procesando reacci贸n</h3>
        <p>Guardando nueva reacci贸n...</p>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="reactions-content" *ngIf="!isLoading && !error">
    
    <!-- Create Reaction Section -->
    <div class="create-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="material-icons">add_circle</i>
        </div>
        <div class="section-info">
          <h3 class="section-title">Crear Nueva Reacci贸n</h3>
          <p class="section-description">Agrega una nueva reacci贸n personalizada al sistema</p>
        </div>
      </div>
      
      <div class="section-content">
        <form [formGroup]="reactionForm" (ngSubmit)="createCustomReaction()" class="create-form">
          <div class="form-grid">
            <div class="form-group">
              <label for="name" class="form-label">
                <i class="material-icons">label</i>
                Nombre de la Reacci贸n
              </label>
              <input 
                formControlName="name" 
                id="name" 
                type="text" 
                class="form-input"
                placeholder="Ej: Me encanta, Incre铆ble, etc."
              >
              <div class="error-message" *ngIf="reactionForm.controls['name'].invalid && reactionForm.controls['name'].touched">
                <i class="material-icons">error</i>
                El nombre es requerido
              </div>
            </div>

            <div class="form-group">
              <label for="emoji" class="form-label">
                <i class="material-icons">emoji_emotions</i>
                Emoji o URL de Imagen
              </label>
              <input 
                formControlName="emoji" 
                id="emoji" 
                type="text" 
                class="form-input"
                placeholder=" o https://ejemplo.com/imagen.png"
              >
              <div class="error-message" *ngIf="reactionForm.controls['emoji'].invalid && reactionForm.controls['emoji'].touched">
                <i class="material-icons">error</i>
                El emoji es requerido
              </div>
            </div>

            <div class="form-group full-width">
              <label for="image" class="form-label">
                <i class="material-icons">upload</i>
                Subir Imagen
              </label>
              <div class="file-upload-container">
                <input 
                  id="image" 
                  type="file"
                  (change)="onFileChange($event)"
                  accept="image/*"
                  class="form-file-input"
                >
                <div class="file-upload-info" *ngIf="!imagePreview">
                  <i class="material-icons">cloud_upload</i>
                  <span>Haz clic para seleccionar una imagen o arrastra aqu铆</span>
                </div>
                <div class="file-preview" *ngIf="imagePreview">
                  <div class="preview-header">
                    <span class="file-name">{{ selectedFileName }}</span>
                    <button type="button" class="remove-file-btn" (click)="removeSelectedFile()">
                      <i class="material-icons">close</i>
                    </button>
                  </div>
                  <div class="preview-image">
                    <img [src]="imagePreview" [alt]="selectedFileName" class="preview-img">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button 
              type="submit" 
              [disabled]="reactionForm.invalid || loadReactionsButtons"
              class="submit-btn"
            >
              <i class="material-icons">add</i>
              <span>Crear Reacci贸n</span>
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Reactions List Section -->
    <div class="reactions-list-section">
      <div class="section-header">
        <div class="section-icon">
          <i class="material-icons">list</i>
        </div>
        <div class="section-info">
          <h3 class="section-title">Reacciones Disponibles</h3>
          <p class="section-description">Lista de todas las reacciones personalizadas creadas</p>
        </div>
        <div class="section-stats">
          <span class="stat-badge">{{ reactionsList.length }} reacciones</span>
        </div>
      </div>
      
      <div class="section-content">
        <div class="reactions-table-container">
          <table class="reactions-table">
            <thead>
              <tr>
                <th class="table-header">
                  <i class="material-icons">label</i>
                  Nombre
                </th>
                <th class="table-header">
                  <i class="material-icons">image</i>
                  Imagen
                </th>
                <th class="table-header actions-header">
                  <i class="material-icons">settings</i>
                  Acciones
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let reaction of reactionsList" class="table-row">
                <td class="table-cell name-cell">
                  <div class="reaction-name">
                    <span class="name-text">{{ reaction.name }}</span>
                  </div>
                </td>
                <td class="table-cell image-cell">
                  <div class="reaction-image">
                    <worky-image 
                      [src]="reaction.emoji" 
                      [alt]="reaction.name + ' icon'" 
                      cssClass="emoji-image">
                    </worky-image>
                  </div>
                </td>
                <td class="table-cell actions-cell">
                  <div class="action-buttons">
                    <button 
                      class="delete-btn"
                      (click)="deleteReaction(reaction._id)"
                      [title]="'Eliminar ' + reaction.name"
                    >
                      <i class="material-icons">delete</i>
                      <span class="btn-text">Eliminar</span>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Empty State -->
          <div class="empty-state" *ngIf="reactionsList.length === 0">
            <div class="empty-content">
              <i class="material-icons empty-icon">emoji_emotions</i>
              <h3>No hay reacciones creadas</h3>
              <p>Crea tu primera reacci贸n personalizada usando el formulario de arriba</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Error State -->
  <div class="error-state" *ngIf="error">
    <div class="error-content">
      <i class="material-icons error-icon">warning</i>
      <h3>Error al cargar reacciones</h3>
      <p>{{ error }}</p>
      <button class="refresh-btn primary" (click)="listReactions()">
        <i class="material-icons">refresh</i>
        <span>Intentar de nuevo</span>
      </button>
    </div>
  </div>
</div>

